<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.mapper.BankCardTypeMapper">
		 
	
	<select id="bankCardTypePageList" resultType="BankCardType" parameterType="BankCardType">	
	   select 
	     t.type_id as typeId,
	     t.type_num as typeNum,
	     t.type_name as typeName, 
	     t.type_pic_name as typePicName,
	     t.type_pic_url as typePicUrl,
	     t.type_info as typeInfo,
	     t.card_of_type as cardOfType
	    from bank_card_type t where 1=1
	    <if test="typeName!=null and typeName!=''">
		 	 and  t.type_name like concat('%',#{typeName},'%')                   
		</if>
		 order by typeId desc
	</select>
	<select id="selectCardOfName" resultType="String" parameterType="String">
	    select group_concat(b.content) as CARDOFNAME from bank_code_info b
        where b.code_type_id = 'ADD_CARD_TYPE' and b.value in 
       <foreach collection="array" item="item" index="index" open="("
				separator="," close=")">#{item}</foreach>
	</select>
	<select id="selectBankCodeInfoList" resultType="java.util.HashMap">
	  select 
		t.value as VALUE,
		t.content as CONTENT
	  from bank_code_info t where t.code_type_id='ADD_CARD_TYPE'
	</select>
	<insert id="insertBankCardType" parameterType="BankCardType">
	  insert into bank_card_type (
	  	   type_num,
		   TYPE_NAME,
		   TYPE_PIC_NAME,
		   TYPE_PIC_URL,
		   TYPE_INFO,
		   CARD_OF_TYPE
		 )
	  values(
	  	  #{typeNum},
		  #{typeName,jdbcType=VARCHAR},
		  #{typePicName,jdbcType=VARCHAR},
		  #{typePicUrl,jdbcType=VARCHAR},
		  #{typeInfo,jdbcType=VARCHAR},
		  #{cardOfType,jdbcType=VARCHAR} 
		)
	
	</insert>
	<delete id="deleteCodeType" >
	    delete from bank_card_type
	    <where>
			type_id  in
			<foreach collection="array" item="item" index="index" open="("
				separator="," close=")">#{item}</foreach>
		</where>
	</delete>
	
	<!-- 查询图片名称 -->
	<select id="selectBankCardTypePics" resultType="String">
	  		select t.TYPE_PIC_NAME as typePicName from bank_card_type t 
	    <where>
			t.type_id  in
			<foreach collection="array" item="item" index="index" open="("
				separator="," close=")">#{item}</foreach>
		</where>
	</select>
	<select id="cardTypeListById" parameterType="String" resultType="BankCardType">
	    select 
	     t.type_id as typeId,
	     t.type_num as typeNum,
	     t.type_name as typeName, 
	     t.type_pic_name as typePicName,
	     t.type_pic_url as typePicUrl,
	     t.type_info as typeInfo,
	     t.card_of_type as cardOfType 
	    from bank_card_type t
	    where  t.type_id=#{typeId,jdbcType=VARCHAR}
	
	</select>
	<update id="updateCardType" parameterType="BankCardType" >
	    UPDATE bank_card_type SET
		 TYPE_NAME=#{typeName,jdbcType=VARCHAR},
		 <if test="typePicName != null and typePicName != ''">
		 	TYPE_PIC_NAME=#{typePicName,jdbcType=VARCHAR},
		 </if>
		 <if test="typePicUrl != null and typePicUrl != '' ">
		 	TYPE_PIC_URL=#{typePicUrl,jdbcType=VARCHAR},
		 </if>
		 TYPE_INFO=#{typeInfo,jdbcType=VARCHAR},
		 CARD_OF_TYPE=#{cardOfType,jdbcType=VARCHAR} 
	   where type_id=#{typeId,jdbcType=VARCHAR}
	</update>
	<select id="selectBankCardTypeBynum" parameterType="String" resultType="int">
	  select count(1) from bank_card_type a where a.TYPE_NUM=#{typeNum,jdbcType=VARCHAR} 
	</select>
	<select id="selectBankCartTypeId" resultType="String">
		SELECT MAX(CAST(TYPE_NUM AS SIGNED INTEGER)) FROM bank_card_type
	</select>
 
	 
</mapper>