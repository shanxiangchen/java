<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.mapper.StoreStagesMapper">

	<resultMap type="StoreStages" id="storeStagesResultMap">
		<id column="STORE_STAGES_ID" property="storeStagesId" />
		<result column="STORE_NO" property="storeNo" />
		<result column="STORE_NAME" property="storeName" />
		<result column="STORE_ADDR" property="storeAddr" />
		<result column="FEE3" property="fee3" />
		<result column="FEE6" property="fee6" />
		<result column="FEE12" property="fee12" />
		<result column="FEE24" property="fee24" />
		<result column="CITYNO" property="cityNo" />
		<result column="MAY_TRANSACT_STAGES_PERIODS" property="mayTransactStagesPeriods" />
		<result column="TRADE_NAME" property="tradeName" />
		<association property="paymentcity" column="CITY_ID"
			javaType="PaymentCity">
			<id column="CITY_ID" property="cityId" />
			<result column="CITY_CODE" property="cityCode" />
			<result column="CITY_NAME" property="cityName" />
			<result column="LEV_NUM" property="levNum" />
		</association>
	</resultMap>


	<resultMap type="StoreStages" id="storeResultMap">
		<id column="STORE_STAGES_ID" property="storeStagesId" />
		<result column="STORE_NO" property="storeNo" />
		<result column="STORE_NAME" property="storeName" />
		<result column="STORE_ADDR" property="storeAddr" />
		<result column="FEE3" property="fee3" />
		<result column="FEE6" property="fee6" />
		<result column="FEE12" property="fee12" />
		<result column="FEE24" property="fee24" />
		<result column="CITYNO" property="cityNo" />
		<result column="MAY_TRANSACT_STAGES_PERIODS" property="mayTransactStagesPeriods" />
		<result column="TRADE_NAME" property="tradeName" />
	</resultMap>

	<select id="selectStoreStagesListPage" resultType="StoreStages"
		resultMap="storeStagesResultMap">
		select
		a.store_stages_id,a.store_no,a.store_name,a.store_addr,a.fee3,a.fee6,a.fee12,
		a.fee24,a.cityno,b.city_name,a.may_transact_stages_periods,a.trade_name
		from bank_store_stages a,bank_payment_city b
		where a.cityno=b.city_code
		<if test="storeName!=null and storeName!=''">
			and a.store_name like "%"#{storeName}"%"
		</if>
		<if test="cityNo!=null and cityNo!=''">
			and a.cityno=#{cityNo,jdbcType=VARCHAR}
		</if>
	</select>
 
	<!-- 批量插入分期商户列表 -->
	<insert id="insertStoreList" parameterType="java.util.List"
		keyProperty="storeStagesId">
		insert into
		bank_store_stages(STORE_NO,STORE_NAME,STORE_ADDR,FEE3,FEE6,FEE12,FEE24,
		CITYNO,TRADE_NAME)
		SELECT
		a.* from (
		<foreach collection="list" item="item" index="index"
			separator="union">
			select
			#{item.storeNo,jdbcType=VARCHAR} a,
			#{item.storeName,jdbcType=VARCHAR} b,
			#{item.storeAddr,jdbcType=VARCHAR} c, #{item.fee3,jdbcType=VARCHAR}
			f,
			#{item.fee6,jdbcType=VARCHAR} g, #{item.fee12,jdbcType=VARCHAR} h,
			#{item.fee24,jdbcType=VARCHAR}
			i,#{item.cityNo,jdbcType=VARCHAR}
			j,#{item.tradeName,jdbcType=VARCHAR} k
			FROM DUAL
		</foreach>
		) a
	</insert>

	<insert id="insertStoreStages" parameterType="StoreStages"
		keyProperty="storeStagesId">
		insert into
		bank_store_stages(STORE_NO,STORE_NAME,STORE_ADDR,FEE3,FEE6,FEE12,FEE24,
		CITYNO,TRADE_NAME)values(#{storeNo,jdbcType=VARCHAR},
		#{storeName,jdbcType=VARCHAR},#{storeAddr,jdbcType=VARCHAR},#{fee3,jdbcType=VARCHAR}
		,#{fee6,jdbcType=VARCHAR},#{fee12,jdbcType=VARCHAR},#{fee24,jdbcType=VARCHAR},#{cityNo,jdbcType=VARCHAR}
		,#{tradeName,jdbcType=VARCHAR})
	</insert>
 
	<select id="getStoreStagesById" parameterType="String"
		resultMap="storeStagesResultMap">
		select
		a.store_stages_id,a.store_no,a.store_name,a.store_addr,a.fee3,a.fee6,a.fee12,
		a.fee24,a.cityno,b.city_name,a.may_transact_stages_periods,a.trade_name
		from bank_store_stages a,bank_payment_city b
		where a.cityno=b.city_code
		and
		a.store_stages_id=#{storeStagesId,jdbcType=VARCHAR}
	</select>



	<update id="updateStoreStages" parameterType="StoreStages">
		update bank_store_stages set
		store_name=#{storeName,jdbcType=VARCHAR},
		store_addr=#{storeAddr,jdbcType=VARCHAR},
		fee3=#{fee3,jdbcType=VARCHAR},
		fee6=#{fee6,jdbcType=VARCHAR},
		fee12=#{fee12,jdbcType=VARCHAR},
		fee24=#{fee24,jdbcType=VARCHAR},
		may_transact_stages_periods=#{mayTransactStagesPeriods,jdbcType=VARCHAR},
		trade_name=#{tradeName,jdbcType=VARCHAR}
		where
		store_stages_id=#{storeStagesId,jdbcType=VARCHAR}
	</update>

	<delete id="deleteStoreStages" parameterType="String">
		delete from
		bank_store_stages where
		store_stages_id=#{storeStagesId,jdbcType=VARCHAR}
	</delete>
	<delete id="deleteStoreStagesAll">
		delete from bank_store_stages where 1=1
	</delete>

	<!--批量删除信息 -->
	<delete id="deleteActShop">
		delete from bank_store_stages  
		<where>
			 store_stages_id in
			<foreach collection="array" item="item" index="index" open="("
				separator="," close=")">#{item}</foreach>
		</where>
	</delete>
	<select id="selectStoreNoList" resultType="java.lang.String">
		select a.store_no as
		store_no from bank_store_stages a
	</select>
 

</mapper>